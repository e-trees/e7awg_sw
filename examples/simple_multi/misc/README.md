# AWG のステータスを読み取る

[read_awg_status.py](./read_awg_status.py) は，全ての AWG のステータスを読み取って出力するスクリプトです．
このスクリプトは，開発者向けのデバッグ用スクリプトです．

## 実行方法

以下のコマンドを実行します．

```
python read_awg_status.py [--ipaddr=AWG コントローラの IP アドレス]
```

# キャプチャユニットのステータスを読み取る
[read_capture_unit_status.py](./read_capture_unit_status.py) は，全てのキャプチャユニットのステータスを読み取って出力するスクリプトです．
このスクリプトは，開発者向けのデバッグ用スクリプトです。

## 実行方法

以下のコマンドを実行します．

```
python read_capture_unit_status.py [--ipaddr=キャプチャユニットの IP アドレス]
```

# AWG及びキャプチャユニットの全てのレジスタをダンプする
[dump_all.py](./dump_all.py) は，全てのAWG及びキャプチャユニットの全レジスタをダンプする開発者向けデバッグスクリプトです。
引数によって、ダンプするレジスタを選択できます。

## 実行例
以下のコマンドで、16個全てのAWGのコントロールレジスタと波形レジスタ、8個全てのキャプチャユニットのコントロールレジスタとパラメタレジスタを出力します。
```bash
python dump_all.py --ipaddr=ボックスのIPアドレス
```
ただし、総和区間やフィルタ、窓関数などの詳細なデータはダンプの対象から外れています。

総和区間などの詳細なデータも含めてダンプする場合には、次のようにします。
```bash
python dump_all.py --ipaddr=ボックスのIPアドレス --cap_param_vector 
```

## ダンプ対象のレジスタグループの選択
ダンプ対象のレジスタの選択は、次の5つのグループ単位で行います。
- AWGのコントロールレジスタ　(`--awg_ctrl`)
- AWGの波形レジスタ（`--awg_wave`）
- キャプチャユニットのコントロールレジスタ（`--cap-ctrl`）
- キャプチャユニットのパラメタジレスタ（`--cap-param`）
- キャプチャユニットのパラメタレジスタのベクトルデータ（`--cap-param-vector`）

ユニットの指定と同様に、ひとつでもダンプ対象のレジスタグループを指定すると、指定したグループだけがダンプの対象になります。
ただし、`--cap_param_vector`だけは例外で、デフォルトの選択を無効化しません。
この振る舞いは、上の2つ目の実行例で見たとおりです。
ベクトルデータは多量のダンプを生成するので、明示的な指定が無い限りダンプしないという特別扱いをしている事情によります。

## ダンプ対象のユニットの選択
最初の実行例で示したとおり、ダンプ対象のユニットを何も指定しないと、全てのAWGと全てのキャプチャユニットがダンプの対象になります。
選択的にダンプを取りたい場合には、`--awgs`でダンプ対象のAWGを、`--caps`でダンプ対象のキャプチャユニットを指定します。
これらのオプションには、カンマ区切りのチャネルのリストが続きます。
たとえば、`--awgs 0,1,2` を指定すると、0, 1, 2番のAWGをダンプが対象になります。
注意が必要なのは、これらのオプションを指定すると、指定のユニット**だけ**がダンプの対象になることです。
キャプチャユニットの指定が無い場合には、全てのキャプチャユニットはダンプの対象から外れます。
同時にキャプチャユニットのダンプを取りたい場合には、`--caps 4,5` のようなオプションを同時に指定します。

```bash
python dump_all.py --ipaddr=ボックスのIPアドレス --awgs 0,1,2,3 --caps 4,5
```

尤もらしい例として、`--cap_param_vector` を使う場合にキャプチャユニットを限定することを考えます。
たとえば、キャプチャユニット6番のベクトルデータを含めた全レジスタファイルのダンプは次のコマンドで取得できます。
```shell
python dump_all.py --ipaddr=ボックスのIPアドレス --caps 6 --cap_param_vector
```

## ユニットとレジスタグループの組み合わせについて
ユニットの指定とレジスタグループは独立しています。
両者を組み合わせて様々な選択的ダンプを取れます。
ただし、次のような何も表示されない組み合わせがいくつかあるので注意が必要です。
```bash
python  dump_all.py --ipaddr 10.5.0.14 --awgs 0 --cap_ctrl
```
この例では、対象ユニットとしてAWGの0番だけを指定したのにも関わらず、キャプチャユニットのレジスタだけを指定しています。
単純に何も表示されないので注意してください。

## TODO
- ビットマップに展開した表示のサポート
- ありがちなユースケースへの表示法などのチューニング
   - 全ダンプを複数回取ってdiffを取るような使い方は割とやるかもな、と思っています。